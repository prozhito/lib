import{__awaiter as t,__generator as i,__assign as r}from"tslib";import{authWithToken as o}from"./actions/auth.js";import{authWithCredentials as e}from"./actions/login.js";var n=function(){function n(t){if(this._user=null,this._loading=!1,this._error="",t&&n._updateCallback.push(t),n._instance)return n._instance;n._instance=this,this.auth=this.auth.bind(this),this.login=this.login.bind(this),this.info=this.info.bind(this),this.logout=this.logout.bind(this)}return Object.defineProperty(n.prototype,"user",{set:function(t){this._user=r({},t)},enumerable:!1,configurable:!0}),n.prototype.emitUpdate=function(){n._updateCallback.forEach((function(t){t&&t()}))},n.prototype.auth=function(e,n){return void 0===e&&(e=""),void 0===n&&(n=""),t(this,void 0,void 0,(function(){var t=this;return i(this,(function(i){return this._loading=!0,this._error="",this._user=null,this.emitUpdate(),[2,o(e,n).then((function(i){return i&&i.error?t._error=i.error:t._user=r({},i.user),t._loading=!1,t.emitUpdate(),i}))]}))}))},n.prototype.login=function(t){var i=this;this._loading=!0,this._error="",this._user=null,this.emitUpdate(),e(t).then((function(t){t&&t.error?i._error=t.error:i._user=r({},t.user),i._loading=!1,i.emitUpdate()}))},n.prototype.logout=function(){console.log("logout"),"undefined"!=typeof document&&(document.cookie="access= ; expires = Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="refresh= ; expires = Thu, 01 Jan 1970 00:00:00 GMT"),this._error="",this._user=null,this.emitUpdate()},n.prototype.info=function(){return{loading:this._loading,error:this._error,user:this._user}},n._updateCallback=[],n}();export{n as Account};
//# sourceMappingURL=account.js.map
